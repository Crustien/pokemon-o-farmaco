<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Pok√©mon o Farmaco?</title>
  <style>
    :root{
      --bg: #0f1226;
      --card:#171a35;
      --ink:#e9ecff;
      --muted:#9aa3d9;
      --accent:#6f8cff;
      --accent-2:#2ee6a6;
      --bad:#ff6b6b;
      --good:#25d29f;
      --shadow: 0 10px 30px rgba(0,0,0,.35);
      --radius: 18px;
    }
    *{box-sizing:border-box}
    html,body{
      margin:0; 
      font: 16px/1.4 system-ui, -apple-system, Segoe UI, Roboto, Inter, "Helvetica Neue", Arial;
      color:var(--ink); 
      background: radial-gradient(1200px 600px at 20% -10%, #203, transparent 60%), radial-gradient(900px 600px at 100% 0%, #032, transparent 60%), var(--bg);
      display:flex; align-items:center; justify-content:center; 
      /* padding responsivo + safe areas (iOS notch) */
      --pad: clamp(16px, 2.5vw, 28px);
      padding: var(--pad);
      padding-left: calc(var(--pad) + env(safe-area-inset-left));
      padding-right: calc(var(--pad) + env(safe-area-inset-right));
      padding-top: calc(var(--pad) + env(safe-area-inset-top));
      padding-bottom: calc(var(--pad) + env(safe-area-inset-bottom));
    }
    body{
      margin:0; font: 16px/1.4 system-ui, -apple-system, Segoe UI, Roboto, Inter, "Helvetica Neue", Arial;
      color:var(--ink); background: radial-gradient(1200px 600px at 20% -10%, #203, transparent 60%), radial-gradient(900px 600px at 100% 0%, #032, transparent 60%), var(--bg);
      display:flex; align-items:center; justify-content:center; padding:28px; 
    }
    .app{ width: min(900px, 100%); }
    header{ display:flex; gap:16px; align-items:center; justify-content:space-between; margin-bottom:18px; }
    .title{ display:flex; align-items:center; gap:12px;}
    .title .logo{ width:42px; height:42px; border-radius:12px; display:grid; place-items:center; background:linear-gradient(135deg, var(--accent), #00ffd0); box-shadow:var(--shadow); font-weight:700; color:#0a1530 }
    h1{ font-size: clamp(18px, 2.5vw, 26px); margin:0; }
    .controls{ display:flex; gap:10px; flex-wrap:wrap; align-items:center; }

    .card{ background:linear-gradient(180deg, rgba(255,255,255,.02), rgba(255,255,255,.01)); border:1px solid #2a2e56; border-radius:var(--radius); box-shadow:var(--shadow); padding:24px; }
    .grid{ display:grid; grid-template-columns: 1fr; gap:16px; }

    .name{
      text-align:center; font-weight:800; letter-spacing:.3px;
      font-size: clamp(34px, 6vw, 64px); margin:8px 0 4px; 
    }
    .hint{ text-align:center; color:var(--muted); font-size:14px; height:20px }

    .choices{ display:flex; gap:14px; justify-content:center; flex-wrap:wrap; margin-top:10px }
    .btn{ cursor:pointer; border:none; border-radius:14px; padding:16px 22px; font-weight:700; letter-spacing:.3px; background:#11142b; color:var(--ink); border:1px solid #2a2e56; transition: transform .05s ease; }
    .btn:hover{ transform: translateY(-1px) }
    .btn:active{ transform: translateY(0) }
    .btn.primary{ background:linear-gradient(135deg, var(--accent), #00ffd0); color:#061225; border:none }
    .btn.good{ background: #07281f; border-color:#0e5; color:#8ff9d8 }
    .btn.bad{ background: #2b0e15; border-color:#f55; color:#ffc7c7 }

    .stats{ display:grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap:12px; justify-items:stretch; color:var(--muted); margin-top:8px }
    .stat{ background:#0b0e20; border:1px solid #2a2e56; padding:10px 12px; border-radius:10px; min-width:110px; text-align:center }
    .stat b{ color:var(--ink) }

    .result{ text-align:center; margin-top:12px; min-height:26px }

    .pill{ display:inline-flex; align-items:center; gap:6px; border-radius:999px; padding:6px 10px; font-size:12px; background:#0b0e20; border:1px solid #2a2e56; color:var(--muted) }
    kbd{ background:#0b0e20; border:1px solid #2a2e56; border-bottom-width:2px; padding:2px 6px; border-radius:6px; font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; font-size:12px; color:var(--ink)}

    .muted{ color:var(--muted) }
  /* Responsive tweaks */
    @media (max-width: 560px){
      header{ flex-direction: column; align-items: stretch; gap:10px }
      .controls{ justify-content:center }
      .choices{ flex-direction: column }
      .choices .btn{ width:100%; font-size:1rem; padding:16px 20px }
      .title .logo{ width:36px; height:36px }
      h1{ font-size: clamp(18px, 5vw, 22px) }
      .name{ font-size: clamp(28px, 9vw, 44px) }
      .stat{ min-width: 0 }
    }
    @media (min-width: 1100px){ .app{ width: min(1000px, 100%) } }
    /* Touch optimizations */
    .coarse .choices .muted{ display:none }
    .coarse .btn:hover{ transform:none }
    @media (pointer: coarse){ .btn{ padding:18px 24px } }
  </style>
</head>
<body>
  <div class="app">
    <header>
      <div class="title">
        <div class="logo">P/F</div>
        <h1>Pok√©mon o <span class="muted">Farmaco?</span></h1>
      </div>
      <div class="controls">        <button id="resetBtn" class="btn">Reset punteggio</button>
      </div>
    </header>

    <div class="grid">
      <section class="card main">
        <div class="pill" id="roundPill">Round <b id="roundNum">1</b></div>
        <div class="name" id="name">‚Äî</div>
        <div class="hint" id="hint">Scegli: farmaco o Pok√©mon?</div>

        <div class="choices">
          <button class="btn primary" id="drugBtn">üíä Farmaco <span class="muted">(F)</span></button>
          <button class="btn primary" id="pokeBtn">üïπÔ∏è Pok√©mon <span class="muted">(P)</span></button>
        </div>

        <div class="result" id="result"></div>

        <div class="stats">
          <div class="stat">Corrette: <b id="correct">0</b></div>
          <div class="stat">Sbagliate: <b id="wrong">0</b></div>
          <div class="stat">Accuratezza: <b id="acc">0%</b></div>
          <div class="stat">Streak: <b id="streak">0</b> (max <b id="best">0</b>)</div>
        </div>
      </section>
    </div>
  </div>

  <script>
    // --- Dataset ------------------------------------------------------------
    // Pok√©mon (Gen 3‚Äì9, molti che "suonano" da farmaco)
    const POKEMON = [
      // Gen 3
      {n:"Illumise", gen:3}, {n:"Manectric", gen:3},
      // Gen 4
      {n:"Gliscor", gen:4}, {n:"Roserade", gen:4},
      // Gen 5
      {n:"Hydreigon", gen:5}, {n:"Reuniclus", gen:5}, {n:"Cofagrigus", gen:5}, {n:"Conkeldurr", gen:5}, {n:"Chandelure", gen:5}, {n:"Excadrill", gen:5}, {n:"Zoroark", gen:5}, {n:"Virizion", gen:5}, {n:"Terrakion", gen:5}, {n:"Cobalion", gen:5}, {n:"Keldeo", gen:5}, {n:"Meloetta", gen:5}, {n:"Genesect", gen:5},
      // Gen 6
      {n:"Greninja", gen:6}, {n:"Aegislash", gen:6}, {n:"Noivern", gen:6}, {n:"Goodra", gen:6}, {n:"Sylveon", gen:6}, {n:"Klefki", gen:6}, {n:"Trevenant", gen:6}, {n:"Xerneas", gen:6}, {n:"Yveltal", gen:6}, {n:"Zygarde", gen:6}, {n:"Carbink", gen:6}, {n:"Diancie", gen:6}, {n:"Hoopa", gen:6}, {n:"Volcanion", gen:6}, {n:"Aurorus", gen:6},
      // Gen 7
      {n:"Toxapex", gen:7}, {n:"Salazzle", gen:7}, {n:"Mimikyu", gen:7}, {n:"Bewear", gen:7}, {n:"Golisopod", gen:7}, {n:"Kommo-o", gen:7}, {n:"Nihilego", gen:7}, {n:"Buzzwole", gen:7}, {n:"Pheromosa", gen:7}, {n:"Xurkitree", gen:7}, {n:"Kartana", gen:7}, {n:"Celesteela", gen:7}, {n:"Stakataka", gen:7}, {n:"Blacephalon", gen:7}, {n:"Poipole", gen:7}, {n:"Naganadel", gen:7}, {n:"Zeraora", gen:7}, {n:"Tapu Koko", gen:7}, {n:"Tapu Lele", gen:7}, {n:"Tapu Bulu", gen:7}, {n:"Tapu Fini", gen:7}, {n:"Vikavolt", gen:7},
      // Gen 8
      {n:"Zacian", gen:8}, {n:"Zamazenta", gen:8}, {n:"Eternatus", gen:8}, {n:"Toxtricity", gen:8}, {n:"Rillaboom", gen:8}, {n:"Cinderace", gen:8}, {n:"Inteleon", gen:8}, {n:"Corviknight", gen:8}, {n:"Dragapult", gen:8}, {n:"Duraludon", gen:8}, {n:"Coalossal", gen:8}, {n:"Falinks", gen:8}, {n:"Copperajah", gen:8}, {n:"Indeedee", gen:8}, {n:"Hatterene", gen:8}, {n:"Polteageist", gen:8}, {n:"Cursola", gen:8}, {n:"Perrserker", gen:8}, {n:"Alcremie", gen:8}, {n:"Urshifu", gen:8}, {n:"Regieleki", gen:8}, {n:"Regidrago", gen:8}, {n:"Calyrex", gen:8}, {n:"Spectrier", gen:8}, {n:"Glastrier", gen:8},
      // Gen 9
      {n:"Koraidon", gen:9}, {n:"Miraidon", gen:9}, {n:"Clodsire", gen:9}, {n:"Gholdengo", gen:9}, {n:"Flutter Mane", gen:9}, {n:"Iron Bundle", gen:9}, {n:"Iron Valiant", gen:9}, {n:"Roaring Moon", gen:9}, {n:"Ting-Lu", gen:9}, {n:"Chien-Pao", gen:9}, {n:"Chi-Yu", gen:9}, {n:"Wo-Chien", gen:9}, {n:"Kingambit", gen:9}, {n:"Tinkaton", gen:9}, {n:"Baxcalibur", gen:9}, {n:"Palafin", gen:9}, {n:"Orthworm", gen:9}, {n:"Lokix", gen:9}, {n:"Bombirdier", gen:9}, {n:"Tatsugiri", gen:9}, {n:"Veluza", gen:9}, {n:"Revavroom", gen:9}, {n:"Dachsbun", gen:9}, {n:"Grafaiai", gen:9}, {n:"Ceruledge", gen:9}, {n:"Armarouge", gen:9}, {n:"Glimmora", gen:9}, {n:"Ogerpon", gen:9}, {n:"Okidogi", gen:9}, {n:"Munkidori", gen:9}, {n:"Fezandipiti", gen:9}, {n:"Terapagos", gen:9}, {n:"Pecharunt", gen:9}
    ];

    // Farmaci (prevalentemente nomi commerciali/brand, mix recenti e noti)
    const DRUGS = [
      {n:"Ozempic"}, {n:"Wegovy"}, {n:"Rybelsus"}, {n:"Mounjaro"}, {n:"Zepbound"}, {n:"Trulicity"}, {n:"Januvia"}, {n:"Jardiance"}, {n:"Farxiga"},
      {n:"Humira"}, {n:"Enbrel"}, {n:"Remicade"}, {n:"Stelara"}, {n:"Cosentyx"}, {n:"Skyrizi"}, {n:"Taltz"}, {n:"Dupixent"}, {n:"Xolair"},
      {n:"Keytruda"}, {n:"Opdivo"}, {n:"Tagrisso"}, {n:"Ibrance"}, {n:"Kisqali"}, {n:"Imbruvica"}, {n:"Darzalex"}, {n:"Xtandi"},
      {n:"Xarelto"}, {n:"Eliquis"}, {n:"Entresto"}, {n:"Xifaxan"}, {n:"Biktarvy"}, {n:"Descovy"}, {n:"Truvada"}, {n:"Genvoya"},
      {n:"Veklury"}, {n:"Paxlovid"}, {n:"Tamiflu"}, {n:"Lagevrio"},
      {n:"Aimovig"}, {n:"Ajovy"}, {n:"Emgality"}, {n:"Nurtec"}, {n:"Ubrelvy"}, {n:"Qulipta"},
      {n:"Trintellix"}, {n:"Cymbalta"}, {n:"Lyrica"}, {n:"Viibryd"}, {n:"Pristiq"},
      {n:"Olumiant"}, {n:"Otezla"}, {n:"Rinvoq"}, {n:"Xeljanz"}, {n:"Cosentyx"},
      {n:"Arexvy"}, {n:"Abrysvo"},
      {n:"Opsumit"}, {n:"Uptravi"}, {n:"Adempas"}, {n:"Aranesp"}, {n:"Rozerem"}, {n:"Voltaren"}, {n:"Actos"}, {n:"Ticlid"}, {n:"Qvar"}, {n:"Crestor"}, {n:"Decadron"}, {n:"Tygacil"}, {n:"Geodon"}, {n:"Clasteon"}, {n:"Finasteride"}, {n:"Minoxidil"}, {n:"Cialis"}, {n:"Tadalafil"}, {n:"Deursil"}, {n:"Botox"}, {n:"Bisoprololo"}
    ];

    // -----------------------------------------------------------------------
    const els = {
      name: document.getElementById('name'),
      hint: document.getElementById('hint'),
      result: document.getElementById('result'),
      correct: document.getElementById('correct'),
      wrong: document.getElementById('wrong'),
      acc: document.getElementById('acc'),
      streak: document.getElementById('streak'),
      best: document.getElementById('best'),
      round: document.getElementById('roundNum'),    };

    const drugBtn = document.getElementById('drugBtn');
    const pokeBtn = document.getElementById('pokeBtn');

    const resetBtn = document.getElementById('resetBtn');

    let deck = [];
    let idx = -1;
    const state = { correct: 0, wrong: 0, streak: 0, best: 0, round: 0 };

    // localStorage for persistence
    const SAVEK = 'pf_stats_v1';
    const saved = JSON.parse(localStorage.getItem(SAVEK) || 'null');
    if(saved){ Object.assign(state, saved); }

    function save(){ localStorage.setItem(SAVEK, JSON.stringify(state)); }

    function buildDeck(){
      const poolP = POKEMON.filter(p=>!p.n.includes(' '));
      const poolD = DRUGS.filter(d=>!d.n.includes(' '));
      const items = [
        ...poolP.map(p=>({ name:p.n, type:'pokemon', info:`Pok√©mon (Gen ${p.gen})` })),
        ...poolD.map(d=>({ name:d.n, type:'drug', info:`Farmaco` }))
      ];
      // Shuffle (Fisher‚ÄìYates)
      for(let i=items.length-1; i>0; i--){
        const j = Math.floor(Math.random()* (i+1));
        [items[i], items[j]] = [items[j], items[i]];
      }
      deck = items; idx = -1;
    }

    function next(){
      if(deck.length===0 || idx>=deck.length-1) buildDeck();
      idx++;
      state.round++; save();
      updateStatsUI();
      const cur = deck[idx];
      els.name.textContent = cur.name;
      els.hint.textContent = 'Farmaco o Pok√©mon?';
      els.result.textContent = '';
    }

    function updateStatsUI(){
      els.round.textContent = state.round;
      els.correct.textContent = state.correct;
      els.wrong.textContent = state.wrong;
      const total = state.correct + state.wrong;
      const acc = total? Math.round((state.correct/total)*100): 0;
      els.acc.textContent = acc+"%";
      els.streak.textContent = state.streak;
      els.best.textContent = state.best;
    }

    function flash(btn, ok){
      btn.classList.remove('good','bad');
      void btn.offsetWidth; // reflow
      btn.classList.add(ok? 'good':'bad');
      setTimeout(()=>btn.classList.remove('good','bad'), 300);
    }

    function answer(choice){
      const cur = deck[idx];
      const ok = cur.type===choice;
      if(ok){
        state.correct++; state.streak++; state.best = Math.max(state.best, state.streak);
        els.result.innerHTML = `‚úÖ Esatto! <b>${cur.name}</b> √® ${cur.type==='drug'? 'un <b>farmaco</b>':'un <b>Pok√©mon</b>'}. <span class="muted">${cur.info||''}</span>`;
        flash(choice==='drug'? drugBtn: pokeBtn, true);
      }else{
        state.wrong++; state.streak = 0;
        els.result.innerHTML = `‚ùå No! <b>${cur.name}</b> √® ${cur.type==='drug'? 'un <b>farmaco</b>':'un <b>Pok√©mon</b>'}. <span class="muted">${cur.info||''}</span>`;
        flash(choice==='drug'? drugBtn: pokeBtn, false);
      }
      save(); updateStatsUI();
      // aumenta il tempo di permanenza del messaggio risultato
      const NEXT_DELAY_MS = 1400;
      setTimeout(next, NEXT_DELAY_MS);
    }

    // (sezione esempi rimossa)

    // Event wiring
    drugBtn.addEventListener('click', ()=>answer('drug'));
    pokeBtn.addEventListener('click', ()=>answer('pokemon'));

    resetBtn.addEventListener('click', ()=>{
      // Soft-confirm interno: alcune anteprime/iframe bloccano window.confirm
      if (resetBtn.dataset.arm === '1') {
        resetBtn.dataset.arm = '0';
        resetBtn.textContent = 'Reset punteggio';
        // azzera stato + storage
        localStorage.removeItem(SAVEK);
        Object.assign(state, {correct:0, wrong:0, streak:0, best:0, round:0});
        save();
        updateStatsUI();
        els.result.textContent = 'üîÅ Punteggio azzerato';
        // ricomincia con un mazzo nuovo
        buildDeck();
        idx = -1;
        next();
      } else {
        resetBtn.dataset.arm = '1';
        const original = 'Reset punteggio';
        resetBtn.textContent = 'Clicca di nuovo per confermare';
        setTimeout(()=>{
          if (resetBtn.dataset.arm === '1') { // timeout, annulla
            resetBtn.dataset.arm = '0';
            resetBtn.textContent = original;
          }
        }, 2000);
      }
    });

    window.addEventListener('keydown', (e)=>{
      if(['INPUT','TEXTAREA'].includes(document.activeElement.tagName)) return;
      const k = e.key.toLowerCase();
      if(k==='f'){ e.preventDefault(); answer('drug'); }
      else if(k==='p'){ e.preventDefault(); answer('pokemon'); }
      else if(e.code==='Space'){ e.preventDefault(); /* niente skip */ }
    });

    // Responsive: detect coarse pointer and toggle class
    (function(){
      const mq = window.matchMedia('(pointer: coarse)');
      const apply = ()=> document.body.classList.toggle('coarse', mq.matches);
      apply();
      if(mq.addEventListener) mq.addEventListener('change', apply); else mq.addListener(apply);
    })();

    // Boot
    buildDeck();
    updateStatsUI();
    next();
  </script>
</body>
</html>
